<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SM LLM Client</title>
    <base href="/" />
    <link href="css/app.css" rel="stylesheet" />
</head>
<body>
    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    
    <script>
        // Enhanced scroll to bottom function
        window.scrollToBottom = function () {
            const chatMessages = document.getElementById('chatMessages');
            if (chatMessages) {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        };

        // Start typing animation
        window.startTypingAnimation = function () {
            console.log('Starting typing animation...');
            
            // Wait a bit for DOM to be ready
            setTimeout(() => {
                const dot1 = document.getElementById('dot1');
                const dot2 = document.getElementById('dot2');
                const dot3 = document.getElementById('dot3');
                
                console.log('Dots found:', { dot1: !!dot1, dot2: !!dot2, dot3: !!dot3 });
                
                if (dot1 && dot2 && dot3) {
                    // Reset all dots first
                    dot1.classList.remove('active');
                    dot2.classList.remove('active');
                    dot3.classList.remove('active');
                    
                    console.log('Starting dot sequence...');
                    
                    // Animate dot 1
                    setTimeout(() => {
                        dot1.classList.add('active');
                        console.log('Dot 1 active');
                    }, 100);
                    
                    // Animate dot 2
                    setTimeout(() => {
                        dot2.classList.add('active');
                        console.log('Dot 2 active');
                    }, 600);
                    
                    // Animate dot 3
                    setTimeout(() => {
                        dot3.classList.add('active');
                        console.log('Dot 3 active');
                    }, 1100);
                } else {
                    console.log('Some dots not found!');
                }
            }, 100);
        };

        // Stop typing animation
        window.stopTypingAnimation = function () {
            console.log('Stopping typing animation...');
            const dot1 = document.getElementById('dot1');
            const dot2 = document.getElementById('dot2');
            const dot3 = document.getElementById('dot3');
            
            if (dot1 && dot2 && dot3) {
                dot1.classList.remove('active');
                dot2.classList.remove('active');
                dot3.classList.remove('active');
                console.log('Animation stopped');
            }
        };

        // Working sound effects function
        window.playSound = function (soundType) {
            try {
                // Create audio context for better browser compatibility
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Generate a simple beep sound
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Different frequencies for different sounds
                let frequency = 800; // Default frequency
                let duration = 0.1; // Default duration
                
                switch (soundType) {
                    case 'send':
                        frequency = 1000; // Higher pitch for send
                        duration = 0.15;
                        break;
                    case 'receive':
                        frequency = 600; // Lower pitch for receive
                        duration = 0.2;
                        break;
                    case 'error':
                        frequency = 400; // Very low pitch for error
                        duration = 0.3;
                        break;
                }
                
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
                
                console.log(`Playing ${soundType} sound`);
            } catch (error) {
                console.log('Sound effect error:', error);
            }
        };

        // Add smooth scroll behavior
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chatMessages');
            if (chatMessages) {
                chatMessages.style.scrollBehavior = 'smooth';
            }
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter to send message
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                const sendButton = document.querySelector('.send-button:not(:disabled)');
                if (sendButton) {
                    sendButton.click();
                }
            }
        });
    </script>
</body>
</html>
