<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SM LLM Client</title>
    <base href="/" />
    <link href="css/app.css" rel="stylesheet" />
</head>
<body>
    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    
    <!-- Audio elements for sound effects -->
    <audio id="sendSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>
    <audio id="receiveSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>
    <audio id="errorSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>
    
    <script>
        // Enhanced scroll to bottom function
        window.scrollToBottom = function () {
            const chatMessages = document.getElementById('chatMessages');
            if (chatMessages) {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        };

        // Start typing animation
        window.startTypingAnimation = function () {
            console.log('Starting typing animation...');
            
            // Wait a bit for DOM to be ready
            setTimeout(() => {
                const dot1 = document.getElementById('dot1');
                const dot2 = document.getElementById('dot2');
                const dot3 = document.getElementById('dot3');
                
                console.log('Dots found:', { dot1: !!dot1, dot2: !!dot2, dot3: !!dot3 });
                
                if (dot1 && dot2 && dot3) {
                    // Reset all dots first
                    dot1.classList.remove('active');
                    dot2.classList.remove('active');
                    dot3.classList.remove('active');
                    
                    console.log('Starting dot sequence...');
                    
                    // Animate dot 1
                    setTimeout(() => {
                        dot1.classList.add('active');
                        console.log('Dot 1 active');
                    }, 100);
                    
                    // Animate dot 2
                    setTimeout(() => {
                        dot2.classList.add('active');
                        console.log('Dot 2 active');
                    }, 600);
                    
                    // Animate dot 3
                    setTimeout(() => {
                        dot3.classList.add('active');
                        console.log('Dot 3 active');
                    }, 1100);
                } else {
                    console.log('Some dots not found!');
                }
            }, 100);
        };

        // Stop typing animation
        window.stopTypingAnimation = function () {
            console.log('Stopping typing animation...');
            const dot1 = document.getElementById('dot1');
            const dot2 = document.getElementById('dot2');
            const dot3 = document.getElementById('dot3');
            
            if (dot1 && dot2 && dot3) {
                dot1.classList.remove('active');
                dot2.classList.remove('active');
                dot3.classList.remove('active');
                console.log('Animation stopped');
            }
        };

        // Sound effects function
        window.playSound = function (soundType) {
            try {
                let audioElement;
                switch (soundType) {
                    case 'send':
                        audioElement = document.getElementById('sendSound');
                        break;
                    case 'receive':
                        audioElement = document.getElementById('receiveSound');
                        break;
                    case 'error':
                        audioElement = document.getElementById('errorSound');
                        break;
                    default:
                        return;
                }
                
                if (audioElement) {
                    audioElement.currentTime = 0;
                    audioElement.play().catch(e => console.log('Sound play failed:', e));
                }
            } catch (error) {
                console.log('Sound effect error:', error);
            }
        };

        // Add smooth scroll behavior
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chatMessages');
            if (chatMessages) {
                chatMessages.style.scrollBehavior = 'smooth';
            }
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter to send message
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                const sendButton = document.querySelector('.send-button:not(:disabled)');
                if (sendButton) {
                    sendButton.click();
                }
            }
        });
    </script>
</body>
</html>
